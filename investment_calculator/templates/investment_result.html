{% extends 'base.html' %}
{% load humanize %}

{% block title %}Investment Results{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mb-4">Investment Results</h1>

    <!-- Plot Section -->
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8">
            <div id="graph" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

    <!-- Table Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th></th>
                            {% for row in table_data %}
                                <th class="text-center">Year {{ row.year }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Future Value</th>
                            {% for row in table_data %}
                                <td class="text-end">${{ row.future_value|floatformat:2|intcomma }}</td>
                            {% endfor %}
                        </tr>
                        <tr>
                            <th>Total Contribution</th>
                            {% for row in table_data %}
                                <td class="text-end">${{ row.total_contribution|floatformat:2|intcomma }}</td>
                            {% endfor %}
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Back Button -->
    <div class="text-center mt-4">
        <a href="{% url 'calculate_investment' %}" class="btn btn-secondary">Try Again</a>
    </div>
</div>

<!-- Plotly JS -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>
    var graph = JSON.parse('{{ graph_json|escapejs }}');
    var config = { responsive: true };
    Plotly.newPlot('graph', graph.data, graph.layout, config);
</script>

<!-- Optional Custom Styles -->
<style>
    /* Ensure the graph scales with its container */
    #graph {
        width: 100%;
        height: 100%;
    }

    /* Adjust plot title and labels for better readability on mobile */
    @media (max-width: 576px) {
        #graph .plotly .main-title {
            font-size: 18px !important;
        }
        #graph .plotly .xtitle, #graph .plotly .ytitle {
            font-size: 14px !important;
        }
        #graph .plotly .legendtitle {
            font-size: 12px !important;
        }
    }
</style>
{% endblock %}
